\documentclass[letter,12pt]{article}
\usepackage[T1]{fontenc}
\usepackage[tc]{titlepic}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage{amsfonts,amsmath,amssymb}
\usepackage{amsthm}
\usepackage{geometry,listings}
%\geometry{margin=2.5cm}
\usepackage{color,xcolor,moreverb}
\usepackage{tikz,graphicx}
\usepackage{fancyhdr}
\usepackage{url}
\usepackage{enumitem}
\usepackage[mathcal]{euscript}
\usepackage{tikz,tkz-tab}
\usepackage{genyoungtabtikz}
\usepackage{bbm, bm}
\usepackage{mathrsfs}
\usepackage{xargs}
%\usepackage{sagetex}
\usepackage{hyperref} 


%Notes
\usepackage[colorinlistoftodos,prependcaption,textsize=small,textwidth=2.5cm]{todonotes}
\newcommand{\pauline}[1]{\todo[linecolor=blue,backgroundcolor=blue!25,bordercolor=blue]{#1}}
\newcommand{\nicolas}[1]{\todo[linecolor=green,backgroundcolor=green!25,bordercolor=green]{#1}}

% Maths
\newcommand{\RR}{\mathbb{R}}
\newcommand{\KK}{\mathbb{K}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\CC}{\mathbb{C}}

\DeclareMathOperator{\Sn}{\mathbb{S}_n}
\DeclareMathOperator{\GLr}{GL_r}
\DeclareMathOperator{\harmonics}{\mathcal{H}}

\newtheorem{theorem}{Theorem}
\newtheorem{conjecture}{Conjecture}
\newtheorem{prop}{Proposition}
\newtheorem{lemme}{Lemma}
\newtheorem{coroll}{Corollary}
\newtheorem{definition}{Definition}


%Tableaux
\newcommand{\diagramme}{\YFrench \Yboxdim{10pt}\yng}
\newcommand{\tableau}{\YFrench \Yboxdim{10pt}\young}
%\newcommand{\diagramme}{\Yboxdim{10pt}\yng}  % notation anglaise
%\newcommand{\tableau}{\Yboxdim{10pt}\young}  % notation anglaise
\newcommand{\petitDiagramme}{\YFrench \Yboxdim{5pt}\yng}
\newcommand{\petitTableau}{\tiny \YFrench \Yboxdim{5pt}\young}
%\newcommand{\petitDiagramme}{\Yboxdim{5pt}\yng}  % notation anglaise
%\newcommand{\petitTableau}{\tiny \Yboxdim{5pt}\young}  % notation anglaise


%%- 1 ère page
\title{Computing the bicharacter of huge subspaces of polynomials}
\author{Pauline Hubert \and Nicolas Thiéry}



\begin{document}
	
	\maketitle 
	
	\begin{abstract}
		... 
	\end{abstract}
	
	\tableofcontents

	
	\section{Introduction}
	This package was developped at the occasion of a collaboration with François Bergeron to study the character of the space $\harmonics_{k,n}$ of diagonal harmonic polynomials on $k$ sets of $n$ variables, as a graded bi-$\GLr \times \Sn$-module. The main achievement is a calculation of this character for $n=6$ \pauline{+ some cases for $n=7$ ?} and $r=5$ (and therefore any $r$) in 45 minutes (and ~15Gb), which led to conjectures on its general value.
	
	This is a potentially huge calculation ($\harmonics_{5,6}$ is of dimension $5.8 \cdot10^5$), involving polynomials of degree up to $15$ in $30$ variables with thousands of terms. So we had to combine several strategies that each reduced the time and/or memory complexity by one or two orders of magnitude. As much as possible, the code was written to be modular and reusable.
	
	\section{Context}
		
	Consider the polynomial ring $P=\QQ[X]$ with $k$ sets of $n$ variables. To fix conventions, we think of $X$ as a matrix of variables: \pauline{small $x$ for variables, capital $X$ for sets of variables? } \pauline{introduce inert variables now or later?}
	$$(X_{i,j})_{0\leq i<k \atop 0\leq j<n}$$
	and we denote by $X_i$ the i-th set of variables. 
	
	The polynomial ring $P$ is endowed with an action of the symmetric group $\Sn$ by diagonal permutation of the columns and of $\GLr$ by diagonal action on the rows. The invariant ring $P^{\Sn}$ is also known as the ring of multisymmetric functions. The co-invariant ring $P_{\Sn}$ is the quotient of $P$ by the ideal $\langle {P^{\Sn^+}} \rangle$ of the multisymmetric functions without constant term. It inherits from $P$ a structure of graded $\GLr \times \Sn$ bi-module.
	
	The grading can be refined into a multigrading by rows. The multigrading is preserved by the action of $\Sn$. The multigrading is not preserved by the action of $\GLr$, but instead carries exactly the information about the $\GLr$ character. It's thus equivalent to consider the $\GLr \times \Sn$ bicharacter or the $\Sn$ multigraded character of $P_{\Sn}$.
	
	When $k=1$, the action of $GL_1$ is trivial; $P_{\Sn}$ is of dimension $n!$ and carries the usual graded representation of $\Sn$. Its character is given by a Hall-Littlewood polynomial.
	When $k=2$, $P_{\Sn}$ is of dimension $(n+1)^{n-1}$ ($=16807$ for $n=6$); as a consequence of Haiman's proof of the $n!$-conjecture (see \cite{Haiman2002}), the bigraded character is a Macdonald polynomial.
	
	Throughout this notebook, we implicitly use the Frobenius map, and identify $\Sn$ and $\GLr$ irreducible characters with their associated Schur symmetric functions. \\
	
	We denote the partial derivative the following way $\partial^k_x := \frac{\partial^k}{\partial x^k}$ for any variable $x$ in $X$.
	
	When $X$ contains only on set of variable ($r=1$), we define the \emph{harmonic polynomials} as follow.
	
	\begin{definition}
		Let $f \in \QQ[X]$, $f$ is \emph{harmonic} if and only if
		$$\partial^k_{x_1} f + \partial^k_{x_2} f + \dots + \partial^k_{x_n} f = 0 $$
		for all $k \geq 0$, $k \in \NN$.
	\end{definition}

	The space of harmonic polynomials in $n$ variables, denoted $\harmonics_{n}$ is the joint kernel of the differential operators $D_k := \partial_{x_1}^k + \cdots + \partial_{x_n}^k$. It is also a realization of the coinvariants of the symmetric group: $\QQ[X]\, /\, \langle Sym(X)^+ \rangle$ and a graded regular representation of $\Sn$. 
	
	As an example, $\harmonics_2 = \langle 1, x_1-x_2 \rangle_\QQ$. 
	
	Note that the Vandermonde determinant $V_n:=$ $\prod_{i<j}(x_i-x_j)$ is harmonic. It is also easy to see that if $f$ is harmonic then $\partial_{x_i} f$ is also harmonic for all $x_i \in X$. \\
	
	Going back to an arbitrary number $r$ of sets of variables, we define the \emph{differential operators} $(D_\alpha)_{\alpha\in \NN^r}$:
	$$D_{(\alpha_1, \dots, \alpha_r)} := \partial_{x_{11}}^{\alpha_1}\dots\partial_{x_{r1}}^{\alpha_r} + \dots + \partial_{x_{1n}}^{\alpha_1}\dots\partial_{x_{rn}}^{\alpha_r} = \sum_{j=1}^{n} \prod_{i=1}^{r} \partial_{x_{ij}}^{\alpha_i}$$
	
	For example, take $r=3$ and denote $x, y$ and $z$ the three sets of variables of $X$, then $D_{(3,0,4)} := \partial_{x_1}^3\partial_{z_1}^4 + \dots + \partial_{x_n}^3\partial_{z_n}^4$. 
	
	The space of the diagonal harmonic polynomials $\harmonics_{n,r}$ is the joint kernel of the $(D_\alpha)_\alpha$. Note that $\harmonics_{n,r}$ contains $\harmonics_{n,1} = \harmonics_{n}$.\\
	
	The previous definition means that the diagonal harmonic polynomials are solutions of differential equations systems. They can also be obtained by construction using polarization operators. 
	
	\begin{definition}
		The \emph{polarisation operator} $P_{x_a,x_b}^k$ is given by
		$$P_{x_a,x_b}^k = \sum_{i=1}^{n} x_{bi} \partial_{x_{ai}}^k$$
		where $x_a$ and $x_b$ are two sets of variables of $X$. 
	\end{definition}

	It is well known (\cite{Haiman2002} and \cite{Bergeron2009}) that the harmonics $\harmonics_{n,1}$ are generated by the Vandermonde determinant $V_n$ and closed by partial derivatives. Moreover, the diagonal harmonics $\harmonics_{n,r}$ are generated by $\harmonics_{n,1}$ and closed by the polarization operators. \\

	
	The diagonal harmonics $\harmonics_{n,r}$ have been studied a lot until now. The character in the case $r=2$ is due to Garsia and Haiman (see \cite{GarsiaHaiman1993}) and some progress in the case $r=3$ had recently been made by Bergeron and Préville-Ratelle (see \cite{BergeronPreville2012}), but the general case is still unknown. Therefore, the computation of those characters should lead to a better understanding of those spaces. 
	
	In their work, Garsia and Haiman also introduced a generalized version of the Vandermonde determinant and a generalization of the diagonal harmonics for two sets of variables called the Gasia-Haiman modules. \\
	
	F. Bergeron recently introduced another generalization of the diagonal harmonics, with inert variables. We add a new row $\theta = (\theta_1, \theta_2, \dots, \theta_n)$ of variables in $X$. The symmetric group still acts diagonally on the rows of $X$, but $GL_r$ now acts only on the rows containing non-inert variables. Like before, we consider the smallest subspace containing a certain determinant and closed by partial derivation and polarization, except that this time the inert variables do not intervene in the operators. The determinant used in this case is defined as follow.   
	 
	Let $\lambda$ be a partition of $n$, we also denote $\lambda$ the Ferrer's diagram associated to the partition $\lambda$ and each cell of $\lambda$ is given by the coordinates of its bottom left corner. Then the determinant $V_{\lambda}$ associated to $\lambda$ is given by $$V_{\lambda} = \det (x_i^a \theta_i^b)_{1 \leq i \leq n \atop (a,b) \in \lambda} .$$
	For example, the partition $21$ contains the cells $(0,0)$ and $(1,0)$ in the first row, and the cell $(0,1)$ in the second row, and $V_{21} = -x_2\theta_1 + x_3\theta_1 + x_1\theta_2 - x_3\theta_2 - x_1\theta_3 + x_2\theta_3$. \\
	
	Since those subspaces are completely new, computing some characters on Sage helps understanding them better and allows to find some properties of thoses spaces. 
	Plus, experimentation helped finding the right definition we needed for this generalization.
	
	\begin{definition} \pauline{find the right place}
		The \emph{Steenrod operator} $St_{x_a}^k$ for $k>1$ is given by
		$$St_{x_a}^k = \sum_{i=1}^{n} x_{ai} \partial_{x_{ai}}^k$$
		where $x_a$ is a set of variables of $X$. 
	\end{definition}


	Only the Steenrod operators for $k=2$ and $k=3$ are necessary since the other operators can be obtained from the two first ones. For example, $St_{x_a}^4 = St_{x_a}^3St_{x_a}^2 - St_{x_a}^2St_{x_a}^3$. 

	Note that $St_{x_a}^k = P_{x_a,x_a}^k$ but we distinguish the two families of operators because they play different roles. 
	
	\section{Strategies}
	
	\subsection{Computing in the space of harmonic polynomials}
	
	We first need to compute in a quotient by an ideal.
	A standard approach would be to compute a Gröbner basis of this ideal.
	We haven't actually tried it, but given the number of variables and dimension of the quotient, we expect this calculation to be intractable.
	
	So we took the classical route of realizing the coinvariant ring as the space $\def\harmonics{\mathcal{H}}\harmonics_{k,n}$ of *diagonal harmonic polynomials*.
	This is the space of those polynomials that satisfy the equations given by the multisymmetric functions seen as differential operators.
	
	Solving those differential equations would not be that tractable either.
	
	\subsection{Polarization: diagonal harmonic polynomials from harmonic polynomials}
	
	Define the polarization operators:
	
	$$P_{i,i'}^d = \sum_j   x_{i',j} \partial_{i,j}^d\,.$$
	
	For $d=1$, those operators implement the action of $sl_k$ induced by $gl_k$.
	
	\begin{theorem}
		Multisymmetric polynomials are obtained by polarization of symmetric polynomials in the first set of variables.
	\end{theorem}
	
	\begin{conjecture}
		Diagonal harmonic polynomials are obtained by polarization of harmonic polynomials in the first set of variables.
	\end{conjecture}
	
	In the sequel, we assume that the above conjecture holds. The space of harmonic polynomials $\harmonics_n$ itself can be constructed, for example, as the subspace spanned by the VanDerMonde determinant under differentiation.
	
	In practice, we implemented a general purpose utility in Sage `Space(vectors, operators)` that computes the smallest subspace of a vector space which contains the given vectors and is stable under the action of the given linear operators.
	
	TODO: put an example here
	
	No rocket science here: maintain a matrix in row echelon form representing a basis of the space computed so far, and a ToDo list of $op(v)$ that remain to be computed and inserted in the matrix.
	
	This utility should already have been in Sage, and will end up there.
	
	Once a basis of $\harmonics_{k,n}$ is constructed, there still remains to recover its bicharacter. For $\GLr$ that's given by the multigrading. For $\Sn$ some additional work has to be done (e.g. computing the traces of the action of permutations of all cycle types).
	
	At this stage, we have an algorithm, but are still doing linear algebra in a huge space (cost $N^2 M$, where $N$ is the dimension of the result and $M$ the dimension of the ambient space).
	
	\subsection{Exploiting the multigrading}
	
	The above utility can be adapted to exploit the multigrading. The input is now a collection of homogeneous vectors and operators together with their multidegrees, and a separate row echelon matrix is maintained for each multidegree.
	
	Advantages:
	- Writing $N=:\sum N_D$, The complexity becomes $(\sum N_D^2) M$ instead of $(\sum N_D)^2M_D$ (in fact better.
	- The multidegrees, and therefore $\GLr$ character, can be directly read off the result.
	
	\subsection{Exploiting representations of the symmetric group}
	
	The polarization operators commute with the action of $\Sn$. Therefore,
	we can compute independently each $\Sn$ isotypic component of $\harmonics_{k,n}$ by starting from a basis of harmonic polynomials that itself is adapted to its decomposition into isotypic components:
	$$\harmonics_{n}=:\bigoplus_\lambda \harmonics^\lambda\,.$$
	
	In fact we can do better.
	
	Fix a partition $\lambda$. Recall that a basis of the Specht module $V_\lambda$ is given by the family of Garnir/Specht polynomials $(G_{P})_P$ indexed by standard tableaux $P$ of shape $\lambda$.
	
	To get a basis of the full isotypic component $\harmonics^\lambda$, we can, for example, use a generalization of this construction (voir \cite{Ariki1997}): a family of polynomials $(G_{P,Q})_{P,Q}$ indexed by a pairs of standard tableaux of shape $\lambda$:
	- $Q$ specifies the copy of $V_\lambda$
	- $P$ specifies the location within that copy of $V_\lambda$
	
	
	Remark: For a fixed tableau $P$, denote by $\harmonics_k^P$ the space spanned by the higher Specht polynomials $(G_{P,Q})_Q$ under polarization. It's exactly the image of $\harmonics$ under the Young idempotent associated to $P$. For a given shape $\lambda$, the $\harmonics_k^P$ are all conjugate under $\Sn$, and their direct sum is the isotypic component $\harmonics_k^\lambda$.
	
	Conclusion: It is sufficient to compute $\harmonics_k^P$ for one tableau of each shape $\lambda$. This reduces the complexity by the square of the number of standard tableaux of shape $\lambda$
	
	\subsection{Exploiting column antisymmetries}
	
	Specht polynomials tend to be big: in $6$ variables, the VanDerMonde determinant has $6!=720$ monomials.
	
	But that's mostly because they are antisymmetric w.r.t. a large column stabilizer $S_P$. It's therefore sufficient to keep one representative monomial per $S_P$ orbit (and do some appropriate straightening whenever a new monomial is created). 
	
	This trick was already used by François for the polarizations of the VanDerMonde (the diagram space). Using higher Specht polynomials further allowed  to generalize that optimization to each shape.
	
	**Gain**: in theory up to $n!$. In practice between one and two orders of magnitude due to the overhead of straightening monomials.
	
	\subsection{Exploiting row symmetries}
	
	$H_k^P$ is symmetric w.r.t. permutation of rows, and such permutations
	exchange multigraded components. For example, for $r=3$, the homogeneous components of respective multidegree $4,2,1$ and $2,1,4$ coincide
	up to cycling of the rows. It is therefore sufficient, in principle, to compute homogeneous components with decreasing multidegree.
	To achieve this, polarization operators can be tweaked: whenever the result of a polarization is not of decreasing multidegree, straighten it by applying an appropriate permutation of the rows. It can then easily be shown that those tweaked polarization operator properly generate the whole $\harmonics_k^P$ space from $\harmonics^P$.
	
	**Gain**: an order of magnitude; below are the total dimension of each $\harmonics_5^\lambda$ and its restriction to homogeneous components of decreasing multidegree:
	
	\subsection{Exploiting representations of $sl_k$}
	
	Building on the previous strategy, it would be tempting to only compute the subspace of $sl_r$ highest weight vectors within each $\harmonics_k^P$.
	
	The current code partially achieves this by avoiding the use of polarization operators of degree $0$ (which clearly would leave the space of highest weight vectors). The obtained space is still too big, and the actual highest weight vectors are obtained by computing the anihilator of the polarization operators $P_{i,i-1}^1$.
	
	The first step requires an additional, not yet proven, trick.
	
	We are currently exploring how to tweak the polarization operators to stabilize the space of highest weight vectors.
	
	**Current gain:** another order of magnitude; down from 3 days to 45 minutes for $\harmonics_5^{1^6}$
	
	**Potential gain:** another order of magnitude, both in time and memory:
	
	\subsection{Exploiting the skew commutation of polarization operators}
	
	The polarization operators skew commute. Therefore it would be in principle sufficient to apply them in some "decreasing order". This sounds promising given that, at this stage about 90\% of the polynomials that are produced are redundant and reduced to zero by the linear algebra.
	
	However we have not yet been able put to use that optimization together with the other $sl_k$ optimizations, because the tweaked polarization operators don't skew commute consistently.
	
	\section{Applications}
	
\bibliographystyle{plain}
\nocite{*}
\bibliography{biblio}
\end{document}